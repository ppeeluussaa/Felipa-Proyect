<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Reservar turno - Felipa</title>
<link rel="stylesheet" href="css/style.css" />
<style>
/* ==========================
   CALENDARIO PROFESIONAL
========================== */
.calendar { max-width: 900px; margin: 30px auto; background-color: #fffaf0; border: 2px solid #f1e4d3; border-radius: 10px; padding: 20px; }
.calendar h2 { text-align: center; color: #bfa66a; margin-bottom: 20px; }
.weekdays, .days { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
.weekdays div { font-weight: bold; text-align: center; color: #bfa66a; }
.day { background-color: #fff; border: 1px solid #f1e4d3; border-radius: 6px; padding: 8px; min-height: 120px; display: flex; flex-direction: column; align-items: center; }
.day.disabled { background-color: #f5f5f5; color: #ccc; }
.day h4 { margin-bottom: 5px; font-size: 0.9rem; }
.horarios button { margin: 2px; padding: 5px 8px; font-size: 0.8rem; border: none; border-radius: 5px; cursor: pointer; background-color: #bfa66a; color: #fff; transition: background 0.2s; }
.horarios button:hover { background-color: #a38f55; }
.horarios button.reservado { background-color: #e4d8b0; color: #999; cursor: default; }
.mensajeReserva { text-align: center; margin-top: 15px; font-weight: bold; color: green; }

/* FORMULARIO DE DATOS */
#formDatos { max-width: 400px; margin: 20px auto 0; padding: 15px; border: 2px solid #f1e4d3; border-radius: 10px; background-color: #fffaf0; display: none; flex-direction: column; gap: 10px; }
#formDatos input { padding: 8px; border-radius: 5px; border: 1px solid #f1e4d3; }
#formDatos button { padding: 10px; border: none; border-radius: 6px; background-color: #bfa66a; color: #fff; cursor: pointer; font-weight: bold; transition: background 0.2s; }
#formDatos button:hover { background-color: #a38f55; }
.confirmacionFinal { text-align: center; font-weight: bold; color: green; margin-top: 15px; }

@media(max-width: 700px) {
  .day { min-height: 100px; }
  .horarios button { padding: 4px 6px; font-size: 0.7rem; }
}

/* ==========================
   NAVBAR RESPONSIVE
========================== */
.navbar nav { display: flex; gap: 15px; }
.navbar .menu-toggle { display: none; background: none; border: none; font-size: 1.5rem; cursor: pointer; }
@media(max-width: 768px) {
  .navbar nav { display: none; flex-direction: column; background: #fff; position: absolute; top: 60px; right: 20px; border: 1px solid #f1e4d3; border-radius: 8px; padding: 10px; }
  .navbar nav.active { display: flex; }
  .navbar .menu-toggle { display: block; }
}
</style>
</head>
<body>
<header class="navbar">
  <div class="logo" onclick="window.location.href='index.html'">
    <img src="imagenes/logo-felipa.jpg" alt="Felipa Logo" class="logo-img" />
    <span>Felipa</span>
  </div>
  <button class="menu-toggle" aria-label="Abrir menú">☰</button>
  <nav>
    <a href="index.html">Inicio</a>
    <a href="reservar.html" class="active">Reservar</a>
    <a href="login.html">Iniciar sesión</a>
  </nav>
</header>

<section class="calendar">
  <h2>Reservá tu turno - <span id="mesActual"></span></h2>
  <div class="weekdays">
    <div>Lun</div><div>Mar</div><div>Mié</div><div>Jue</div>
    <div>Vie</div><div>Sáb</div><div>Dom</div>
  </div>
  <div class="days" id="diasMes"></div>
  <div class="mensajeReserva" id="mensajeReserva"></div>
</section>

<form id="formDatos">
  <h3>Completá tus datos</h3>
  <input type="text" id="nombre" placeholder="Nombre y Apellido" required />
  <input type="email" id="correo" placeholder="Correo electrónico" required />
  <input type="tel" id="telefono" placeholder="Número de teléfono" required />
  <button type="submit">Confirmar turno</button>
  <div class="confirmacionFinal" id="confirmacionFinal"></div>
</form>

<script>
const menuToggle = document.querySelector('.menu-toggle');
const nav = document.querySelector('.navbar nav');
menuToggle.addEventListener('click', () => nav.classList.toggle('active'));

const diasMesContainer = document.getElementById("diasMes");
const mensajeReserva = document.getElementById("mensajeReserva");
const mesActualSpan = document.getElementById("mesActual");
const formDatos = document.getElementById("formDatos");
const confirmacionFinal = document.getElementById("confirmacionFinal");

const horariosDisponibles = ["08:00", "10:00", "14:00", "17:00", "19:00"];
const fechaHoy = new Date();
const año = fechaHoy.getFullYear();
const mes = fechaHoy.getMonth();
const nombreMeses = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
mesActualSpan.textContent = nombreMeses[mes] + " " + año;

let turnoSeleccionado = null;
let turnos = JSON.parse(localStorage.getItem("turnos")) || [];

const primerDiaMes = new Date(año, mes, 1).getDay();
const cantidadDiasMes = new Date(año, mes + 1, 0).getDate();

for (let i = 1; i <= cantidadDiasMes; i++) {
  const diaDiv = document.createElement("div");
  diaDiv.classList.add("day");
  const diaSemana = (new Date(año, mes, i).getDay() + 6) % 7;
  if(i === 1) diaDiv.style.gridColumnStart = diaSemana + 1;

  const fecha = new Date(año, mes, i);
  if(fecha < fechaHoy) diaDiv.classList.add("disabled");

  const h4 = document.createElement("h4");
  h4.textContent = i;
  diaDiv.appendChild(h4);

  const horariosDiv = document.createElement("div");
  horariosDiv.classList.add("horarios");

  if(!diaDiv.classList.contains("disabled")) {
    horariosDisponibles.forEach(hora => {
      const btn = document.createElement("button");
      btn.textContent = hora;

      if(turnos.some(t => t.dia===i && t.mes===mes+1 && t.hora===hora)) {
        btn.classList.add("reservado");
        btn.disabled = true;
      }

      btn.addEventListener("click", () => {
        turnoSeleccionado = { dia:i, mes:mes+1, año, hora };
        formDatos.style.display = "flex";
        confirmacionFinal.textContent = "";
        mensajeReserva.textContent = `⏳ Completá tus datos para confirmar el turno: ${i}/${mes+1} a las ${hora}`;
      });

      horariosDiv.appendChild(btn);
    });
  }

  diaDiv.appendChild(horariosDiv);
  diasMesContainer.appendChild(diaDiv);
}

formDatos.addEventListener("submit", (e) => {
  e.preventDefault();
  const nombre = document.getElementById("nombre").value;
  const correo = document.getElementById("correo").value;
  const telefono = document.getElementById("telefono").value;

  const nuevoTurno = { ...turnoSeleccionado, nombre, correo, telefono };
  turnos.push(nuevoTurno);
  localStorage.setItem("turnos", JSON.stringify(turnos));

  confirmacionFinal.textContent = `✅ Turno confirmado para ${turnoSeleccionado.dia}/${turnoSeleccionado.mes} a las ${turnoSeleccionado.hora}`;
  mensajeReserva.textContent = "";
  formDatos.reset();
  formDatos.style.display = "none";

  diasMesContainer.innerHTML = "";
  location.reload();
});
</script>
</body>
</html>
